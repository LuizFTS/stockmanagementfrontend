<!-- Backdrop para mobile -->
<div
  class="backdrop"
  [class.active]="active"
  [class.fade-in]="active"
  [class.fade-out]="!active"
  (click)="toggleSidebar(false)"
></div>

<!-- Navegação principal -->
<nav class="nav" [class.active]="active">
  <!-- Container do menu -->
  <div class="menu-container" [class.active]="active">
    <!-- Header -->
    <header class="menu-container__header">
      <h1 class="menu-container__header__title">stockmanagement</h1>
      <stk-sidebar-menu-option icon="menu" (action)="toggleSidebar(!active)" />
    </header>

    <!-- Lista de seções do menu -->
    <ul class="menu-container__sections">
      @for (section of menuData; track section.id; let sectionIndex = $index) {
        <li class="menu-container__section" [class.active]="isSectionActive(sectionIndex)">
          <!-- Botão da seção -->
          <stk-sidebar-menu-option
            [icon]="section.icon"
            [text]="section.label"
            [arrow]="hasArrow(section) ? 'arrow_back_ios_new' : null"
            [barActive]="active"
            [itemActive]="isSectionActive(sectionIndex)"
            (action)="handleSectionClick(sectionIndex)"
          />

          <!-- Subitens (apenas se não for Home e estiver ativo) -->
          @if (shouldShowSubItems(sectionIndex)) {
            <ul class="menu-container__subitems">
              @for (item of section.items; track item.path; let itemIndex = $index) {
                <li
                  class="menu-container__subitem"
                  routerLinkActive="active"
                  [routerLinkActiveOptions]="{ exact: true }"
                >
                  <stk-sidebar-menu-sub-option
                    [text]="item.label"
                    [path]="item.path"
                    [active]="isItemActive(sectionIndex, itemIndex)"
                    (close)="handleItemClick(itemIndex)"
                  />
                </li>
              }
            </ul>
          }
        </li>
      }
    </ul>
  </div>

  <!-- Footer da sidebar -->
  <footer class="sidebar-footer" [class.active]="active">
    <!-- Botão de perfil -->
    <stk-sidebar-menu-option
      icon="account_circle"
      [text]="userName"
      [barActive]="active"
      [itemActive]="isSectionActive(-1)"
      (action)="handleSectionClick(-1)"
    />

    <!-- Botão de logout -->
    <stk-sidebar-menu-option icon="logout" (action)="logout()" />
  </footer>
</nav>
